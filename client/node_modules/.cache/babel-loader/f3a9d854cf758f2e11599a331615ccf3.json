{"ast":null,"code":"var _jsxFileName = \"D:\\\\Documents\\\\HKII_2020_2021\\\\Tieu_Luan_CN\\\\code\\\\tlcn\\\\client\\\\src\\\\components\\\\mainpages\\\\history\\\\OrderHistory.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useEffect } from 'react';\nimport { GlobalState } from '../../../GlobalState';\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\nimport { useSelector } from 'react-redux';\nimport \"aos/dist/aos.css\";\nimport { Table, Tag, Space } from 'antd';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction OrderHistory() {\n  _s();\n\n  const state = useContext(GlobalState);\n  const [history, setHistory] = state.userAPI.history;\n  const token = useSelector(state => state.token);\n  const auth = useSelector(state => state.auth);\n  const {\n    isLogged,\n    isAdmin\n  } = auth;\n  useEffect(() => {\n    if (token) {\n      const getHistory = async () => {\n        if (isAdmin) {\n          const res = await axios.get('/api/payment', {\n            headers: {\n              Authorization: token\n            }\n          });\n          console.log(\"test-history:\" + res);\n          setHistory(res.data);\n        } else {\n          const res = await axios.get('/user/history', {\n            headers: {\n              Authorization: token\n            }\n          });\n          console.log(\"test-history:\" + res);\n          setHistory(res.data); //res.data.role === 1 ? setIsAdmin(true) : setIsAdmin(false) \n          //setCart(res.data.cart) \n        }\n      };\n\n      getHistory();\n    }\n  }, [token, isAdmin, setHistory]);\n  const columns = [{\n    title: 'Payment ID',\n    dataIndex: 'paymentID',\n    key: 'paymentID'\n  }, {\n    title: 'Date of Purchased',\n    dataIndex: 'createdAt',\n    key: 'createdAt'\n  }, {\n    title: 'Action',\n    key: 'action',\n    render: () => /*#__PURE__*/_jsxDEV(Space, {\n      size: \"middle\",\n      children: /*#__PURE__*/_jsxDEV(Link, {\n        children: \"View\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 15\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 13\n    }, this)\n  }];\n\n  const rederHistory = his => {\n    let myHistory = [];\n    his.map(h => {\n      myHistory.push({\n        key: h._id,\n        paymentID: h.paymentID,\n        createdAt: new Date(h.createdAt).toLocaleDateString()\n      });\n    });\n    return myHistory;\n  };\n\n  const data = [{\n    key: '1',\n    name: 'John Brown',\n    age: 32,\n    tags: ['nice', 'developer']\n  }];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container mt-20\",\n    children: /*#__PURE__*/_jsxDEV(Table, {\n      columns: columns,\n      dataSource: rederHistory(history)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 9\n  }, this);\n}\n\n_s(OrderHistory, \"e9uVJzzRp/uiOe6nzU6RsX4X+hM=\", false, function () {\n  return [useSelector, useSelector];\n});\n\n_c = OrderHistory;\nexport default OrderHistory;\n\nvar _c;\n\n$RefreshReg$(_c, \"OrderHistory\");","map":{"version":3,"sources":["D:/Documents/HKII_2020_2021/Tieu_Luan_CN/code/tlcn/client/src/components/mainpages/history/OrderHistory.js"],"names":["React","useContext","useEffect","GlobalState","Link","axios","useSelector","Table","Tag","Space","OrderHistory","state","history","setHistory","userAPI","token","auth","isLogged","isAdmin","getHistory","res","get","headers","Authorization","console","log","data","columns","title","dataIndex","key","render","rederHistory","his","myHistory","map","h","push","_id","paymentID","createdAt","Date","toLocaleDateString","name","age","tags"],"mappings":"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","sourcesContent":["import React, {useContext, useEffect} from 'react'\r\nimport {GlobalState} from '../../../GlobalState'\r\nimport {Link} from 'react-router-dom'\r\nimport axios from 'axios'\r\nimport {useSelector} from 'react-redux'\r\nimport \"aos/dist/aos.css\"\r\nimport { Table, Tag, Space } from 'antd';\r\n\r\nfunction OrderHistory() {\r\n    const state = useContext(GlobalState)\r\n    const [history, setHistory] = state.userAPI.history\r\n    const token = useSelector(state => state.token)\r\n    const auth = useSelector(state => state.auth)\r\n    const {isLogged, isAdmin} = auth\r\n\r\n    useEffect(() =>{\r\n        if(token){\r\n            const getHistory = async () =>{\r\n                if(isAdmin)\r\n                {\r\n                    const res = await axios.get('/api/payment', {\r\n                        headers: {Authorization: token}\r\n                    })\r\n                    console.log(\"test-history:\"+ res)\r\n \r\n                     setHistory(res.data)\r\n                }\r\n                else{\r\n                    const res = await axios.get('/user/history', {\r\n                        headers: {Authorization: token}\r\n                    })\r\n                    console.log(\"test-history:\"+ res)\r\n \r\n                     setHistory(res.data)\r\n                    //res.data.role === 1 ? setIsAdmin(true) : setIsAdmin(false) \r\n\r\n                    //setCart(res.data.cart) \r\n                }\r\n            }\r\n\r\n            getHistory()\r\n                }\r\n\r\n    },[token, isAdmin, setHistory])\r\n    \r\n    const columns = [\r\n        {\r\n          title: 'Payment ID',\r\n          dataIndex: 'paymentID',\r\n          key: 'paymentID'\r\n        },\r\n        {\r\n          title: 'Date of Purchased',\r\n          dataIndex: 'createdAt',\r\n          key: 'createdAt',\r\n        },\r\n        {\r\n          title: 'Action',\r\n          key: 'action',\r\n          render: () => (\r\n            <Space size=\"middle\">\r\n              <Link>View</Link>\r\n            </Space>\r\n          ),\r\n        },\r\n      ];\r\n\r\n      const rederHistory = (his) =>{\r\n          let myHistory =[];\r\n          his.map((h) => {\r\n            myHistory.push({\r\n            key: h._id,\r\n            paymentID: h.paymentID,\r\n            createdAt: new Date(h.createdAt).toLocaleDateString()\r\n          });\r\n        });\r\n        return myHistory;\r\n      }\r\n\r\n      const data = [\r\n        {\r\n          key: '1',\r\n          name: 'John Brown',\r\n          age: 32,\r\n          tags: ['nice', 'developer'],\r\n        }\r\n      ];\r\n      \r\n    return (\r\n        <div className=\"container mt-20\">\r\n            <Table columns={columns} dataSource={rederHistory(history)} />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default OrderHistory;"]},"metadata":{},"sourceType":"module"}